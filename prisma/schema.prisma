generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Ponente {
  id            String   @id @default(uuid())

  // Ponente 1 (obligatorio)
  nombres       String
  apellidos     String
  tipoDocumento String
  documento     String
  email         String
  telefono      String

  // Ponente 2 (opcional)
  nombres2       String?
  apellidos2     String?
  tipoDocumento2 String?
  documento2     String?
  email2         String?
  telefono2      String?

  pais          String
  ciudad        String

  // Académico (opcional — puede ser profesional)
  universidad   String?
  programa      String?
  semestre      String?

  // Opcionales
  grupoInvestigacion String?
  semillero          String?

  tituloPonencia String
  resumen        String
  lineaTematica  String

  // URLs Cloudinary
  ponenciaPdfUrl       String
  cesionDerechosPdfUrl String

  // Estados
  verificado Boolean @default(false)
  agendado   Boolean @default(false)

  // Agenda (múltiples franjas)
  agenda     PonenteAgenda[]

  createdAt  DateTime @default(now())

  @@map("ponentes")
}

model PonenteAgenda {
  id        String   @id @default(uuid())
  ponenteId String
  ponente   Ponente  @relation(fields: [ponenteId], references: [id], onDelete: Cascade)

  fecha     DateTime // guardamos fecha (00:00)
  inicio    String   // "14:00"
  fin       String   // "18:00"

  createdAt DateTime @default(now())

  @@index([ponenteId])
  @@map("ponentes_agenda")
}

model Evaluador {
  id            String   @id @default(uuid())

  nombres       String
  apellidos     String
  tipoDocumento String
  documento     String
  email         String
  telefono      String

  pais          String
  ciudad        String

  // Pregrado
  universidad   String  // universidad del pregrado

  profesion           String
  posgrado            String
  universidadPosgrado String

  // Docencia (condicional)
  esDocente           String  // "si" | "no"
  programaDocencia    String?
  universidadDocencia String?

  // Estados
  verificado Boolean @default(false)
  agendado   Boolean @default(false)

  // Agenda
  agenda     EvaluadorAgenda[]

  createdAt  DateTime @default(now())

  @@map("evaluadores")
}

model EvaluadorAgenda {
  id          String    @id @default(uuid())
  evaluadorId String
  evaluador   Evaluador @relation(fields: [evaluadorId], references: [id], onDelete: Cascade)

  fecha     DateTime
  inicio    String
  fin       String

  createdAt DateTime @default(now())

  @@index([evaluadorId])
  @@map("evaluadores_agenda")
}

model Asistente {
  id            String   @id @default(uuid())

  nombres       String
  apellidos     String
  tipoDocumento String
  documento     String
  email         String
  telefono      String

  pais          String
  ciudad        String

  // opcional: si aplica (estudiante/docente)
  universidad   String?
  programa      String?
  semestre      String?

  createdAt     DateTime @default(now())

  @@map("asistentes")
}
